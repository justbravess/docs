# Документация к API Кузбасс-Цот

Сервис предоставляет возможности по проведению тестирования пользователей по вопросам охраны труда.

Ответ приходит в виде MIME-type: application/json

Методы:
* Создать тест
* Получить статус тестирования
* Получить результаты тестирования
* Получить вопрос
* Дать ответ на вопрос

Объекты:
* Token
* Aftermath
* Question
* Answer

## Методы

### Создать тест
	POST /tokens/generate/{spec_id}

URL-params: 

| Имя     | Тип | Обязателен | Описание                                                        |
|---------|-----|------------|-----------------------------------------------------------------|
| spec_id | int | да         | Идентификатор специальности для которой проводится тестирование |

Success Response:

```javascript
Объект Token
```
Error Response:
```javascript
{
    "code": 404,
    "message": "No question with such id"
}
```

### Получить статус тестирования
	GET /tokens/{token_key}/status

URL-params: 

| Имя     | Тип | Обязателен | Описание                                                        |
|---------|-----|------------|-----------------------------------------------------------------|
| token_key | string | да         | Хэш-ключ тестирования |

Success Response:

```javascript
{
    "status": int // 1-для сгенерированного тестирования, 2-неоконченное, 3-оконченное
}
```
Error Response:
```javascript
{
    "code": 404,
    "message": "No token with such key"
}
```

### Получить результат тестирования
	GET /tokens/{token_key}/results

URL-params: 

| Имя     | Тип | Обязателен | Описание                                                        |
|---------|-----|------------|-----------------------------------------------------------------|
| token_key | string | да         | Хэш-ключ тестирования |

Success Response:

```javascript
{
    "right": int,
    "total": int,
    "risk": float,
    "aftermath": [
       Объект Aftermath
    ]
}
```
Error Response:
```javascript
{
    "code": 404,
    "message": "No token with such key"
}
```
### Получить вопрос

	GET /questions/{question_id}

URL-params: 

| Имя     | Тип | Обязателен | Описание                                                        |
|---------|-----|------------|-----------------------------------------------------------------|
| question_id | int | да         | Идентификатор вопроса |

Success Response:

```javascript
Объект Question
```
Error Response:
```javascript
{
    "code": 404,
    "message": "No question with such id"
}
```
### Дать ответ на вопрос

	POST /questions/save

Data-Params: 

| Имя         | Тип    | Обязателен | Описание              |
|-------------|--------|------------|-----------------------|
| token_key   | string | да         | Хэш-ключ тестирования |
| question_id | int    | да         | Идентификатор вопроса |
| answer_id   | int    | да         | Идентификатор ответа  |

Success Response:

MIME-type: application/json
```javascript
Объект Token
```
Error Response:
```javascript
{
    "code": 400,
    "message": "Data is not valid"
}
```

## Объекты

### Token
| Поле               | Тип       | Коментарий                                                  |
|--------------------|:---------:|-------------------------------------------------------------|
| key                | string    | Хэш-ключ тестирования                                       |
| status             | int       | Статус тестирования 1 - создано 2 - неокончено 3 - окончено |
| questions          | array int | Массив идентификаторов вопросов для тестирования            |
| answered_questions | int       | Количество вопросов, на которые дан ответ                   |
| total_questions    | int       | Общее количество вопросов                                   |

### Aftermath
| Поле             | Тип    | Коментарий                                                    |
|------------------|:------:|---------------------------------------------------------------|
| question_text    | string | Текст вопроса                                                 |
| user_answer      | string | Ответ данный пользователем                                    |
| status           | string | true - в случае  если ответ верный false - неверный           |
| right_answer     | string | Правильный ответ                                              |
| aftermath_text   | string | Текст последствия неверного ответа. Пустой для верного ответа |
| aftermath_factor | string | Фактор поражения неверного ответа. Пустой для верного ответа  |
### Question
| Поле        | Тип          | Коментарий                                                                      |
|-------------|:------------:|---------------------------------------------------------------------------------|
| id          | int          | Идентификатор вопроса                                                           |
| text        | string       | Текст вопроса                                                                   |
| type        | int          | Идентификатор типа вопроса 8 - текстовый вопрос 9 - видеовопрос 21 - фотовопрос |
| type_label  | string       | Тип вопроса txt - текстовый вопрос smph - фотовопрос smvd - видеовопрос         |
| attach      | string       | ссылка на вложение. Пустая в случае текстового вопроса                          |
| attach_type | string       | Тип вложения none - текстовый вопрос photo - фотовопрос video - видеовопрос     |
| answers     | array Answer | Массив объектов Answer. Содержит ответы на вопрос.                              |
### Answer
| Поле | Тип    | Коментарий           |
|------|:------:|----------------------|
| id   | int    | Идентификатор ответа |
| text | string | Текст ответа         |
